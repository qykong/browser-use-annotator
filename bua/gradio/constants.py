import os

from bua.interface.browser import BrowserComputerInterface

LANG = "English"
OUTPUT_DIR = "examples/output"
SESSION_DIR = os.path.join(OUTPUT_DIR, "sessions")
computer: BrowserComputerInterface | None = None
tool_call_logs = []
memory = ""
last_action = {"name": "", "action": "", "arguments": {}}
last_screenshot = None  # Store the most recent screenshot
last_screenshot_before = None  # Store the most [-2]th recent screenshot
screenshot_images = []  # Array to store all screenshot images


LANGUAGES = {
    "English": {
        "title": "Browser Action Annotation Tool",
        "current_screenshot": "Current Screenshot",
        "click_type": "Click Type",
        "wait": "WAIT",
        "done": "DONE", 
        "fail": "FAIL",
        "conversational_logs": "Conversational Logs",
        "function_logs": "Function Logs",
        "clear_log": "Clear Log",
        "save_share_demos": "Save/Share Demonstrations",
        "all_sessions": "All Sessions",
        "upload_sessions_hf": "Upload Sessions to HuggingFace",
        "hf_dataset_name": "HuggingFace Dataset Name",
        "dataset_visibility": "Dataset Visibility",
        "filter_by_tags": "Filter by tags (optional)",
        "filter_by_tags_info": "When tags are selected, only demonstrations with those tags will be uploaded. Leave empty to upload all sessions.",
        "demo_name": "Demonstration Name",
        "demo_name_placeholder": "Enter a name for this demonstration",
        "demo_tags": "Demonstration Tags",
        "demo_tags_info": "Select existing tags or create new ones",
        "save_current_session": "Save Current Session",
        "save_status": "Save Status",
        "upload_status": "Upload Status",
        "memory_scratchpad": "Memory / Scratchpad",
        "current_memory": "Current Memory",
        "submit_memory": "Submit Memory",
        "refine": "Refine",
        "status": "Status",
        "tasks": "Tasks",
        "current_task": "Current Task",
        "randomize_task": "ğŸ² Randomize Task",
        "run_task_setup": "âš™ï¸ Run Task Setup",
        "setup_status": "Setup Status",
        "os": "OS",
        "initialize_computer": "Initialize Computer",
        "type_text": "Type Text",
        "press_enter": "Press Enter",
        "submit_text": "Submit Text",
        "go_to_url": "Go to URL",
        "submit_url": "Submit URL",
        "select_keys": "Select Keys",
        "select_keys_info": "Select one or more keys to send as a hotkey",
        "send_hotkeys": "Send Hotkey(s)",
        "scrolling": "Scrolling",
        "number_of_clicks": "Number of Clicks",
        "scroll_up": "Scroll Up",
        "scroll_down": "Scroll Down",
        "reasoning_last_action": "Reasoning for Last Action",
        "last_action": "Last Action",
        "thought_process": "What was your thought process behind this action?",
        "thought_process_placeholder": "Enter your reasoning here...",
        "mark_erroneous": "Mark this action as erroneous (sets weight to 0)",
        "submit_reasoning": "Submit Reasoning",
        "conversation_messages": "Conversation Messages",
        "message_role": "Message Role",
        "message_content": "Message Content",
        "message_content_placeholder": "Enter message here...",
        "screenshot_after_msg": "Receive screenshot after message",
        "submit_message": "Submit Message",
        "message_status": "Message Status",
        "clipboard_operations": "Clipboard Operations",
        "clipboard_content": "Clipboard Content",
        "get_clipboard": "Get Clipboard Content",
        "set_clipboard_text": "Set Clipboard Text",
        "set_clipboard": "Set Clipboard",
        "run_shell_commands": "Run Shell Commands",
        "command_to_run": "Command to run",
        "run_command": "Run Command",
        "command_output": "Command Output",
        "shutdown_computer": "Shutdown Browser",
        "language": "Language",
        "public": "public",
        "private": "private",
        "current_task_placeholder": "Enter current task here...",
        "triple_click": "Triple Click",
        "message_editor": "Message Editor",
        "input_text_placeholder": "Enter text here to type into the browser...",
    },
    "ä¸­æ–‡": {
        "title": "æµè§ˆå™¨æ“ä½œæ ‡æ³¨å·¥å…·",
        "current_screenshot": "å½“å‰æˆªå›¾",
        "click_type": "ç‚¹å‡»ç±»å‹",
        "wait": "ç­‰å¾…",
        "done": "å®Œæˆ",
        "fail": "å¤±è´¥", 
        "conversational_logs": "å¯¹è¯æ—¥å¿—",
        "function_logs": "åŠŸèƒ½æ—¥å¿—",
        "clear_log": "æ¸…é™¤æ—¥å¿—",
        "save_share_demos": "ä¿å­˜/åˆ†äº«æ¼”ç¤º",
        "all_sessions": "æ‰€æœ‰ä¼šè¯",
        "upload_sessions_hf": "ä¸Šä¼ ä¼šè¯åˆ°HuggingFace",
        "hf_dataset_name": "HuggingFaceæ•°æ®é›†åç§°",
        "dataset_visibility": "æ•°æ®é›†å¯è§æ€§",
        "filter_by_tags": "æŒ‰æ ‡ç­¾ç­›é€‰ï¼ˆå¯é€‰ï¼‰",
        "filter_by_tags_info": "é€‰æ‹©æ ‡ç­¾æ—¶ï¼Œåªä¼šä¸Šä¼ åŒ…å«è¿™äº›æ ‡ç­¾çš„æ¼”ç¤ºã€‚ç•™ç©ºåˆ™ä¸Šä¼ æ‰€æœ‰ä¼šè¯ã€‚",
        "demo_name": "æ¼”ç¤ºåç§°",
        "demo_name_placeholder": "è¾“å…¥æ­¤æ¼”ç¤ºçš„åç§°",
        "demo_tags": "æ¼”ç¤ºæ ‡ç­¾",
        "demo_tags_info": "é€‰æ‹©ç°æœ‰æ ‡ç­¾æˆ–åˆ›å»ºæ–°æ ‡ç­¾",
        "save_current_session": "ä¿å­˜å½“å‰ä¼šè¯",
        "save_status": "ä¿å­˜çŠ¶æ€",
        "upload_status": "ä¸Šä¼ çŠ¶æ€",
        "memory_scratchpad": "è®°å¿†/ä¾¿ç­¾",
        "current_memory": "å½“å‰è®°å¿†",
        "submit_memory": "æäº¤è®°å¿†",
        "refine": "ä¼˜åŒ–",
        "status": "çŠ¶æ€",
        "tasks": "ä»»åŠ¡",
        "current_task": "å½“å‰ä»»åŠ¡",
        "randomize_task": "ğŸ² éšæœºä»»åŠ¡",
        "run_task_setup": "âš™ï¸ è¿è¡Œä»»åŠ¡è®¾ç½®",
        "setup_status": "è®¾ç½®çŠ¶æ€",
        "os": "æ“ä½œç³»ç»Ÿ",
        "initialize_computer": "åˆå§‹åŒ–æµè§ˆå™¨",
        "type_text": "è¾“å…¥æ–‡å­—",
        "press_enter": "æŒ‰å›è½¦é”®",
        "submit_text": "æäº¤æ–‡å­—",
        "go_to_url": "è®¿é—®ç½‘å€",
        "submit_url": "æäº¤ç½‘å€",
        "select_keys": "é€‰æ‹©æŒ‰é”®",
        "select_keys_info": "é€‰æ‹©ä¸€ä¸ªæˆ–å¤šä¸ªæŒ‰é”®ä½œä¸ºçƒ­é”®å‘é€",
        "send_hotkeys": "å‘é€çƒ­é”®",
        "scrolling": "æ»šåŠ¨",
        "number_of_clicks": "ç‚¹å‡»æ¬¡æ•°",
        "scroll_up": "å‘ä¸Šæ»šåŠ¨",
        "scroll_down": "å‘ä¸‹æ»šåŠ¨",
        "reasoning_last_action": "æœ€åæ“ä½œçš„æ¨ç†",
        "last_action": "æœ€åæ“ä½œ",
        "thought_process": "æ‚¨è¿›è¡Œæ­¤æ“ä½œçš„æ€è·¯æ˜¯ä»€ä¹ˆï¼Ÿ",
        "thought_process_placeholder": "åœ¨æ­¤è¾“å…¥æ‚¨çš„æ¨ç†...",
        "mark_erroneous": "å°†æ­¤æ“ä½œæ ‡è®°ä¸ºé”™è¯¯ï¼ˆæƒé‡è®¾ä¸º0ï¼‰",
        "submit_reasoning": "æäº¤æ¨ç†",
        "conversation_messages": "å¯¹è¯æ¶ˆæ¯",
        "message_role": "æ¶ˆæ¯è§’è‰²",
        "message_content": "æ¶ˆæ¯å†…å®¹",
        "message_content_placeholder": "åœ¨æ­¤è¾“å…¥æ¶ˆæ¯...",
        "screenshot_after_msg": "æ¶ˆæ¯åæ¥æ”¶æˆªå›¾",
        "submit_message": "æäº¤æ¶ˆæ¯",
        "message_status": "æ¶ˆæ¯çŠ¶æ€",
        "clipboard_operations": "å‰ªè´´æ¿æ“ä½œ",
        "clipboard_content": "å‰ªè´´æ¿å†…å®¹",
        "get_clipboard": "è·å–å‰ªè´´æ¿å†…å®¹",
        "set_clipboard_text": "è®¾ç½®å‰ªè´´æ¿æ–‡å­—",
        "set_clipboard": "è®¾ç½®å‰ªè´´æ¿",
        "run_shell_commands": "è¿è¡ŒShellå‘½ä»¤",
        "command_to_run": "è¦è¿è¡Œçš„å‘½ä»¤",
        "run_command": "è¿è¡Œå‘½ä»¤",
        "command_output": "å‘½ä»¤è¾“å‡º",
        "shutdown_computer": "å…³é—­æµè§ˆå™¨",
        "language": "è¯­è¨€",
        "public": "å…¬å¼€",
        "private": "ç§æœ‰",
        "current_task_placeholder": "åœ¨æ­¤è¾“å…¥å½“å‰ä»»åŠ¡...",
        "triple_click": "ä¸‰å‡»",
        "message_editor": "æ¶ˆæ¯ç¼–è¾‘å™¨",
        "input_text_placeholder": "åœ¨æ­¤è¾“å…¥æ–‡å­—ä»¥è¾“å…¥æµè§ˆå™¨...",
    }
}

title_mappings = {
                "wait": "â³ Waiting...",
                "done": "âœ… Task Completed",
                "fail": "âŒ Task Failed",
                "memory.update": "ğŸ§  Memory Updated",
                "screenshot": "ğŸ“¸ Taking Screenshot",
                "move_cursor": "ğŸ–±ï¸ Moving Cursor",
                "left_click": "ğŸ–±ï¸ Left Click",
                "right_click": "ğŸ–±ï¸ Right Click",
                "double_click": "ğŸ–±ï¸ Double Click",
                "type_text": "âŒ¨ï¸ Typing Text",
                "press_key": "âŒ¨ï¸ Pressing Key",
                "send_hotkey": "âŒ¨ï¸ Sending Hotkey",
                "copy_to_clipboard": "ğŸ“‹ Copying to Clipboard",
                "set_clipboard": "ğŸ“‹ Setting Clipboard",
                "run_command": "ğŸ–¥ï¸ Running Shell Command",
                "initialize": "ğŸš€ Initializing Computer",
                "shutdown": "ğŸ›‘ Shutting Down",
                "triple_click": "ğŸ–±ï¸ Triple Click"
            }

